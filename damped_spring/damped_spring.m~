function [ vargout ] = damped_spring(vargin )
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here

[t,y] = ode45(@ode,[0 1000],[0.1; 0.1; 0.1]);

plot(t,y(:,1),'-o',t,y(:,2),'-o',t,y(:,3),'-o')
title('Solution of a damped spring with ODE45');
xlabel('Time t');
ylabel('Solution y');
legend('y_1','y_2','y_3')

s = [flip(t);t(2:end)];

phi(:,1) = y(:,1);
for j = 2:length(t)
    phi(:,j) = circshift(phi(:,j-1),[1,0]); phi(1:j-1,j) = 0;
end

H = 1/2*(y(:,2) + sqrt(2*0.01)*phi(:,1)).^2 + 1/2*y(:,1).^2 + trapz(t,norm(gradient(phi,diff(s),diff(t))).^2,2);

end

function dydt = ode(t,y)
%VDP1  Evaluate the van der Pol ODEs for mu = 1
%
%   See also ODE113, ODE23, ODE45.

%   Jacek Kierzenka and Lawrence F. Shampine
%   Copyright 1984-2014 The MathWorks, Inc.

dydt = [y(3); -y(1); -y(1)-0.01*y(3)];
end