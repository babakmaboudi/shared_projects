\section{Introduction}
\label{sec:intro}

Reduced order models have emerged as a powerful approach to cope with the evermore complex new applications in engineering and science. These methods, specially the reduced basis (RB) methods, substantially reduce the dimensionality of the problem by constructing a reduced order configuration space. Exploration of the reduced space is then possible with significant acceleration \cite{hesthaven2015certified,Haasdonk2017}.

Over the past decade, RB methods had a great success in lowering the computational costs of solving elliptic and parabolic differential equations \cite{ito1998reduced,ito2001reduced}. However, model reduction of hyperbolic problems remains one of the today's challenges. These problems often arise from a set of conservation laws and invariants. Such intrinsic structures are lost over the course of model reduction which result in a qualitatively wrong, and sometimes unstable reduced system \cite{Amsallem:2014ef}.

Moreover, simulation of reduced models incurs solution error and estimation of this error is essential in the applications of model reduction \cite{HaasdonkOhlberger11,RuinerEtAl12,BhattEtAl18}. Finding tight error bounds for the reduced system has shown to be computationally expensive and often impractical. Therefore, when one is interested in a cheap surrogate for the error incurred or when the conserved quantity is an output of the system, it becomes imperative to preserve system structures through model order reduction.

%To have a sense of this error, error estimation is important from applications point of view \cite{HaasdonkOhlberger11,RuinerEtAl12,BhattEtAl18}. But it can difficult and expensive to compute useful error bounds. When one is interested in a cheap surrogate for the error incurred or when the conserved quantity is an output of the system, it becomes imperative to preserve this structure through model order reduction.

Recently, constructing RB methods that can conserve intrinsic structures has attracted a vast attention \cite{doi:10.1137/17M1111991,1705.00498,kalashnikova2014stabilization,farhat2015structure,doi:10.1137/110836742,doi:10.1137/140959602,beattie2011structure,doi:10.1137/140978922}. Structure preservation in model reduction, not only constructs a physically meaningful reduced system, but it can also enhance the robustness and stability of the reduced system. In system theory, conservation of passivity can be found in the work of \cite{polyuga2010structure,gugercin2012structure}. Energy preserving and inf-sup stable methods for finite element methods (FEM) are developed in \cite{farhat2015structure,ballarin2015supremizer}. Also, a conservative model reduction technique for finite-volume method is seen in \cite{1711.11550}.

In the context of Lagrangian and Hamiltonian systems, recent works provide a promising approach to constructing a robust and stable reduced system. Carlberg, Tuminaro, and Boggs \cite{Carlberg:2014ky} suggest that a reduced order model of a Lagrangian system should be identified by an approximated Lagrangian on a reduced order configuration space. This allows the reduced system to inherit the geometric structure of the original system. Similar approach has been adopted in the work of Maboudi Afkham and Hesthaven \cite{doi:10.1137/17M1111991} and also in the work of Peng and Mohseni \cite{doi:10.1137/140978922} for Hamiltonian systems. They construct a low-order symplectic linear vector space, i.e. a vector space equipped with a symplectic 2-form, as the reduced space. Once the symplectic reduced space is generated, a symplectic projection result in a physically meaningful reduced system. A proper time-stepping scheme can then preserve the Hamiltonian structure of the reduced system. It is shown in \cite{doi:10.1137/17M1111991,doi:10.1137/140978922} that this approach preserves the overall dynamics of the original system and helps with the stability of the reduced system. Despite the success of these method in model reduction of Hamiltonian systems, these problems are only compatible with the standard Euclidean or the $L^2$ inner product. Therefore, the computational structures that arise from a natural inner product of a problem will be lost over model reduction.

Weak formulations and inner-products defined on a Hilbert space are at the core of the error analysis of many numerical methods for solving partial differential equations. Therefore, it is natural to seek for model reduction methods that consider such features. At discrete level, these features often require a Euclidean vector space to be equipped with a generalized inner product associated with a weight matrix $X$. Many works have been conducted to make conventional model reduction techniques compatible with such inner products \cite{sen2006natural}. However, a model reduction method that simultaneously preserves the symplectic symmetry of Hamiltonian systems is still unknown. 

In this paper, we attempt to combine the classical model reduction method with respect to a weight matrix with the symplectic model reduction. The reduced system constructed by the new method is a generalized Hamiltonian system and the low order configuration space associated with this system is a symplectic linear vector space with a non-standard symplectic 2-form. It is demonstrated that the new method can be viewed as the natural extension to \cite{doi:10.1137/17M1111991}, therefore, it carries the structure preserving features, e.g. symplecticness and stability. We also present a greedy approach for constructing a generalized symplectic basis for the reduced system. It is well known that structured matrices are in general not norm bounded \cite{Karow:2006cf}. We show that the condition number of the basis generated by the greedy method is bounded by the condition number of the weight matrix $X$. Finally, to accelerate the evaluation of nonlinear terms in the reduced system, we present a variation of the discrete empirical interpolation method (DEIM) that preserves the symplectic structure of the reduced system.

What remains of this paper is organized as follows. In \cref{sec:hamil} we cover the required background on the Hamiltonian and the generalized Hamiltonian systems. \Cref{sec:mor} summarizes the classical model reduction routine with respect to a weight norm and the symplectic model reduction method with respect to the standard Euclidean inner product. We introduce the symplectic model reduction method with respect to a weighted inner product in \cref{sec:normmor}. \Cref{sec:res} illustrates the performance of the new method through numerical simulation of the equations governing a vibrating beam and the sine-Gordon equation. We offer conclusive remarks in \cref{sec:conc}.
