\section{Introduction}
\label{sec:intro}

Reduced order models have emerged as a powerful approach to cope with increasingly complex new applications in engineering and science. These methods substantially reduce the dimensionality of the problem by constructing a reduced configuration space. Exploration of the reduced space is then possible with significant acceleration \cite{hesthaven2015certified,Haasdonk2017}.

Over the past decade, reduced basis (RB) methods have demonstrated great success in lowering of the computational costs of solving elliptic and parabolic differential equations \cite{ito1998reduced,ito2001reduced}. However, model order reduction (MOR) of hyperbolic problems remains a challenge. Such problems often arise from a set of conservation laws and invariants. These intrinsic structures are lost during MOR which results in a qualitatively wrong, and sometimes unstable reduced system \cite{Amsallem:2014ef}.

%To have a sense of this error, error estimation is important from applications point of view \cite{HaasdonkOhlberger11,RuinerEtAl12,BhattEtAl18}. But it can difficult and expensive to compute useful error bounds. When one is interested in a cheap surrogate for the error incurred or when the conserved quantity is an output of the system, it becomes imperative to preserve this structure through model order reduction.

Recently, the construction of RB methods that conserve intrinsic structures has attracted attention \cite{doi:10.1137/17M1111991,1705.00498,kalashnikova2014stabilization,farhat2015structure,doi:10.1137/110836742,doi:10.1137/140959602,beattie2011structure,doi:10.1137/140978922}. Structure preservation in MOR not only constructs a physically meaningful reduced system, but can also enhance the robustness and stability of the reduced system. In system theory, conservation of passivity can be found in the work of \cite{polyuga2010structure,gugercin2012structure}. Energy preserving and inf-sup stable methods for finite element methods (FEM) are developed in \cite{farhat2015structure,ballarin2015supremizer}. Also, a conservative MOR technique for finite-volume methods is proposed in \cite{1711.11550}.

Moreover, the simulation of reduced models incurs solution errors and the estimation of this error is essential in applications of MOR \cite{HaasdonkOhlberger11,RuinerEtAl12,BhattEtAl18}. Finding tight error bounds for a general reduced system has shown to be computationally expensive and often impractical. Therefore, when one is interested in a cheap surrogate for the error or when the conserved quantity is an output of the system, it becomes imperative to preserve system structures in the reduced model.

In the context of Lagrangian and Hamiltonian systems, recent works provide a promising approach to the construction of robust and stable reduced systems. Carlberg, Tuminaro, and Boggs \cite{doi:10.1137/140959602} suggest that a reduced order model of a Lagrangian system be identified by an approximate Lagrangian on a reduced order configuration space. This allows the reduced system to inherit the geometric structure of the original system. A similar approach has been adopted in the work of Peng and Mohseni \cite{doi:10.1137/140978922} and in the work of Maboudi Afkham and Hesthaven \cite{doi:10.1137/17M1111991} for Hamiltonian systems. They construct a low-order symplectic linear vector space, i.e. a vector space equipped with a symplectic 2-form, as the reduced space. Once the symplectic reduced space is generated, a symplectic projection result in a physically meaningful reduced system. A proper time-stepping scheme then preserves the Hamiltonian structure of the reduced system. It is shown in \cite{doi:10.1137/17M1111991,doi:10.1137/140978922} that this approach preserves the overall dynamics of the original system and enhances the stability of the reduced system. Despite the success of these method in MOR of Hamiltonian systems, these techniques are only compatible with the Euclidean inner product. Therefore, the computational structures that arise from a natural inner product of a problem will be lost during MOR.

Weak formulations and inner-products, defined on a Hilbert space, are at the core of the error analysis of many numerical methods for solving partial differential equations. Therefore, it is natural to seek MOR methods that consider such features. At the discrete level, these features often require a Euclidean vector space to be equipped with a generalized inner product, associated with a weight matrix $X$. Many works enabled conventional MOR techniques compatible with such inner products \cite{sen2006natural}. However, a MOR method that simultaneously preserves the symplectic symmetry of Hamiltonian systems remains unknown. 

In this paper, we seek to combine a classical MOR method with respect to a weight matrix with the symplectic MOR. Generalized inner products often require a state transformation to a non-canonical coordinate system. This restricts the choices of symplectic integrators that can be used in a numerical integration of the reduced system. The reduced system constructed by the new method, however, is a Hamiltonian system on a symplectic linear vector space with a canonical coordinate system. Therefore, any symplectic integrator can ensure long-time and robust numerical integration. It is demonstrated that the new method can be viewed as the natural extension to \cite{doi:10.1137/17M1111991}, and therefore retains the structure preserving features, e.g. symplecticity and stability. We also present a greedy approach for the construction of a generalized symplectic basis for the reduced system. Symplectic bases are often non-orthogonal and therefore not norm bounded. However, we show that the condition number of the basis generated by the greedy method is bounded by the condition number of the weight matrix $X$. Finally, to accelerate the evaluation of nonlinear terms in the reduced system, we present a variation of the discrete empirical interpolation method (DEIM) that preserves the symplectic structure of the reduced system.

What remains of this paper is organized as follows. In \cref{sec:hamil} we cover the required background on the Hamiltonian and the generalized Hamiltonian systems. \Cref{sec:mor} summarizes classic MOR routine with respect to a weighted norm and the symplectic MOR method with respect to the standard Euclidean inner product. We introduce the symplectic MOR method with respect to a weighted inner product in \cref{sec:normmor}. \Cref{sec:res} illustrates the performance of the new method through a vibrating beam and the sine-Gordon equation. We offer a few conclusive remarks in \cref{sec:conc}.
